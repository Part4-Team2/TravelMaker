echo 'lint 검사 중...'

pnpm lint

# 변경된 파일 가져오기, 여기서 --diff-filter=ACM 옵션은 추가(A), 변경(C), 이동(M)만 포함
changed_files=$(git diff --name-only --staged --diff-filter=ACM)

if [ $? -ne 0 ]; then
  echo "lint 에러 발생! 변경된 파일을 가져오는 중 오류가 발생했습니다."
  exit 1
fi

# 변경된 파일들을 다시 스테이징합니다.
echo "$changed_files" | while IFS= read -r file; do
  git add "$file"
done

if [ $? -ne 0 ]; then
  echo "lint 에러 발생! 파일을 다시 스테이징하는 중 오류가 발생했습니다."
  exit 1
fi

echo 'lint 성공!'
